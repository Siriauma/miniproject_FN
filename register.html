<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/moment@2.29.1/moment.min.js"></script>
  <style>
    body {
      font-family: 'Rubik', sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f1f8ff; /* ‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏™‡∏≥‡∏£‡∏≠‡∏á */
      color: #333; /* ‡∏™‡∏µ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ */
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      /* ‡πÉ‡∏™‡πà‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á */
      background-image: url('101560185_xl-scaled.jpg'); /* ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô URL ‡∏´‡∏£‡∏∑‡∏≠‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏Ç‡∏≠‡∏á‡∏£‡∏π‡∏õ */
      background-size: cover; /* ‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏´‡πâ‡∏†‡∏≤‡∏û‡πÄ‡∏ï‡πá‡∏°‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ */
      background-position: center; /* ‡∏à‡∏±‡∏î‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á */
      background-repeat: no-repeat; /* ‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏†‡∏≤‡∏û‡∏ã‡πâ‡∏≥ */
  }
  

    /* Sidebar */
    .sidebar {
      position: fixed;
      left: -250px;
      top: 0;
      width: 250px;
      height: 100%;
      background: #00a86b;
      transition: left 0.3s ease-in-out;
      padding-top: 60px;
      color: white;
    }
    /* ‡∏™‡∏µ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡πÉ‡∏ô‡πÄ‡∏°‡∏ô‡∏π*/
    .sidebar a {
      display: block;
      padding: 15px;
      text-decoration: none;
      color: white;
      font-size: 18px;
      transition: 0.3s;
    }

    .sidebar a:hover {
      background: rgba(255, 255, 255, 0.2);
    }

    .sidebar.show {
      left: 0;
    }

    /* ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏°‡∏ô‡∏π */
    .open-btn {
      position: fixed;
      left: 20px;
      top: 20px;
      background: #00a86b;
      color: white;
      border: none;
      padding: 10px 15px;
      cursor: pointer;
      border-radius: 5px;
      font-size: 16px; /* Increased font size */
      font-weight: 600; /* Bold font */
    }

    /* Card */
    .card {
      background-color: #edfff1d4;
      padding: 40px;
      border-radius: 20px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      width: 420px;
      text-align: center;
      margin: 20px;
    }

    h1 {
      font-size: 36px; /* ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô */
      color: #006a61;
      margin-bottom: 10px;
      font-weight: 700;
    }

    h2 {
      font-size: 20px; /* ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô */
      color: #000000; 
      margin-bottom: 20px;
      font-weight: 500;
    }

    .input-field, .role-select {
      width: 100%;
      padding: 14px;
      margin: 12px 0;
      border: 2px solid #00954d;
      border-radius: 12px;
      font-size: 16px; /* Increased font size for inputs */
      background-color: #ffffff;
      color: #000000; /* Input text color */
    }
    /* ‡∏õ‡∏∏‡πà‡∏° ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô */
    .button {
      width: 100%;
      padding: 14px;
      background-color: #00a86b;
      color: white;
      border: none;
      border-radius: 12px;
      font-size: 18px; 
      font-weight: 600; 
      cursor: pointer;
      transition: background 0.3s;
    }

    .button:hover {
      background-color: #00d98a; /* Darker color on hover */
    }

    .hidden-fields {
      display: none;
      margin-top: 20px;
    }

    .loading {
      display: none;
      margin-top: 20px;
      color: #00a86b;
      font-weight: 500; /* Increased weight for loading text */
    }

    .footer {
      margin-top: 20px;
      font-size: 14px; /* Smaller font size for footer */
      color: #00553a; /* Lighter color for footer text */
    }
  </style>
</head>
<body>

  <!-- Open Sidebar Button -->
  <button class="open-btn" onclick="toggleSidebar()">‚ò∞ ‡πÄ‡∏°‡∏ô‡∏π</button>

  <!-- Sidebar -->
  <div class="sidebar" id="mySidebar">
    <a href="home.html">üè† ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>
    <a href="register.html">üìù ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</a>
    <a href="health.html">‚ù§Ô∏è ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û</a>
    <a href="#" onclick="toggleSidebar()">‚ùå ‡∏õ‡∏¥‡∏î‡πÄ‡∏°‡∏ô‡∏π</a>
  </div>

  <div class="card">
    <h1>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</h1>
    <h2>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô</h2>

    <select class="role-select" id="role" onchange="toggleFields()">
      <option value="caregiver">‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•</option>
      <option value="elderly">‡∏ú‡∏π‡πâ‡∏™‡∏π‡∏á‡∏≠‡∏≤‡∏¢‡∏∏</option>
    </select>

    <input type="text" class="input-field" id="username" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ" required>
    <input type="password" class="input-field" id="password" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô" required>
    <input type="text" class="input-field" id="name" placeholder="‡∏ä‡∏∑‡πà‡∏≠" required>

    <!-- Fields ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏™‡∏π‡∏á‡∏≠‡∏≤‡∏¢‡∏∏ -->
    <div id="elderly-fields" class="hidden-fields">
      <input type="number" class="input-field" id="age" placeholder="‡∏≠‡∏≤‡∏¢‡∏∏" required>
      <select class="input-field" id="gender">
        <option value="" disabled selected>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏û‡∏®</option>
        <option value="Male">‡∏ä‡∏≤‡∏¢</option>
        <option value="Female">‡∏´‡∏ç‡∏¥‡∏á</option>
      </select>

      <!-- Dropdown ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏• ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å populate ‡∏à‡∏≤‡∏Å API -->
      <select class="input-field" id="caregiver-id" required>
        <option value="" disabled selected>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•</option>
      </select>
    </div>

    <button class="button" onclick="registerUser()">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</button>
    <div class="loading" id="loading">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô... ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà.</div>

    <div class="footer">
      <p>‡∏´‡∏≤‡∏Å‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏™‡∏á‡∏™‡∏±‡∏¢ ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà‡∏ù‡πà‡∏≤‡∏¢‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô</p>
    </div>
  </div>

  <script>
    // Toggle Sidebar
    function toggleSidebar() {
      document.getElementById("mySidebar").classList.toggle("show");
    }

    // Populate caregivers from API
    function populateCaregivers() {
      const caregiverSelect = document.getElementById('caregiver-id');
      caregiverSelect.innerHTML = '<option value="" disabled selected>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•</option>';

      fetch('https://im-i62-231-mini-project-bn.vercel.app/api/caregivers')
        .then(response => response.json())
        .then(data => {
          data.forEach(caregiver => {
            const option = document.createElement('option');
            option.value = caregiver.id;
            option.textContent = caregiver.name;
            caregiverSelect.appendChild(option);
          });
        })
        .catch(error => {
          console.error('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•:', error);
        });
    }

    // Call populateCaregivers when DOM loads
    document.addEventListener('DOMContentLoaded', () => {
      populateCaregivers();
    });

    // Toggle fields for elderly
    function toggleFields() {
      const role = document.getElementById('role').value;
      document.getElementById('elderly-fields').style.display = role === 'elderly' ? 'block' : 'none';
    }

    // Register user
    function registerUser() {
      const role = document.getElementById('role').value;
      const username = document.getElementById('username').value.trim();
      const password = document.getElementById('password').value.trim();
      const name = document.getElementById('name').value.trim();

      // Validate general information
      if (!username || !password || !name) {
        alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô');
        return;
      }

      const data = {
        username: username,
        password: password,
        name: name,
        role: role
      };

      // If elderly, validate and add related data
      if (role === 'elderly') {
        const age = document.getElementById('age').value.trim();
        const gender = document.getElementById('gender').value;
        const caregiverId = document.getElementById('caregiver-id').value;

        if (!age || isNaN(age) || age <= 0) {
          alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏≠‡∏≤‡∏¢‡∏∏‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ö‡∏ß‡∏Å');
          return;
        }
        if (!gender || !caregiverId) {
          alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏™‡∏π‡∏á‡∏≠‡∏≤‡∏¢‡∏∏');
          return;
        }

        data.age = age;
        data.gender = gender;
        data.caregiver_id = caregiverId;
      }

      // Show loading indicator
      document.getElementById('loading').style.display = 'block';

      // Send data to API for registration
      fetch('https://im-i62-231-mini-project-bn.vercel.app/api/register', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(data),
      })
      .then(response => response.json())
      .then(data => {
        console.log('‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô:', data);
        alert('‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
        window.location.href = 'register_success.html';
      })
      .catch(error => {
        console.error('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î:', error);
        alert('‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß');
      })
      .finally(() => {
        // Hide loading indicator
        document.getElementById('loading').style.display = 'none';
      });
    }
  </script>
</body>
</html>
